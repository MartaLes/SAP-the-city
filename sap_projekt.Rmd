---
title: "projekt_SAP_demo"
output: html_document
date: "2025-12-06"
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# instalacija - samo za prvi put
install.packages(c("tidyverse", "GGally", "ggcorrplot"))

```

```{r}
library(tidyverse)
library(GGally)   
library(ggcorrplot)
```

```{r}
dataset <- read_csv('Personality_data.csv')
```

```{r}
head(dataset)
```

```{r}
names(dataset)
```

```{r}

glimpse(dataset)
```

```{r}
colSums(is.na(dataset))
```

```{r}
# odabir 
traits_vars <- dataset %>%
  select(
    depression, anxiety, stress,
    narcissism, machiavelism, psychoticism, sadism,
    neuroticism, extraversion, openness, agreeableness, conscientiousness
  )

# korelacijska matrica
corr_mat <- cor(traits_vars, use = "pairwise.complete.obs")

# korelacijska heatmapa
ggcorrplot(
  corr_mat,
  type = "lower",
  lab = TRUE,
  lab_size = 3,
  hc.order = TRUE,
  outline.col = "white"
)

```

Osobe s većom anksioznošću, depresijom i stresom imaju tendenciju biti i
više neurotične.

Mračne osobine su međusobno umjereno povezane.

Visoka savjesnost štiti od depresije i stresa (negativna korelacija).

Ugodnost je snažno suprotna psihoticizmu i sadizmu.

Big Five su međusobno slabo do umjereno povezane.

Najveće korelacije su:

Psychoticism–Sadism (0.65) Depression–Neuroticism (0.58)
Extraversion-Narcissism(0.56) Machiavelism–Psychoticism (0.51)

```{r}
table(dataset$sex)
df_sex <- dataset %>%
  filter(sex %in% c("Male", "Female"))

```

```{r}
big_five <- df_sex %>%
  pivot_longer(
    cols = c(neuroticism, extraversion, openness, agreeableness, conscientiousness),
    names_to = "trait",
    values_to = "score"
  )

ggplot(big_five, aes(x = sex, y = score, fill = sex)) +
  geom_boxplot() +
  facet_wrap(~ trait, scales = "free") +
  theme_minimal() +
  labs(
    title = "Big Five osobine po spolu (Male vs Female)",
    x = "Spol",
    y = "Rezultat"
  )

```

U ovom uzorku se pojavljuju obrasci u skladu s očekivanjima.

Najveće razlike bilježimo kod neurotizcizma (žene više) i ugodnost (žene
više). Kod ekstraverzije, otvorenosti i savjesnosti ne bilježimo velike
razlike što se tiče medijana.

```{r}
df_clean <- dataset |> 
  filter(sex %in% c("Male", "Female"))

ggplot(df_clean, aes(sample = neuroticism)) +
  stat_qq() + stat_qq_line() +
  facet_wrap(~sex)

ggplot(df_clean, aes(sample = agreeableness)) +
  stat_qq() + stat_qq_line() +
  facet_wrap(~sex)

ggplot(df_clean, aes(sample = openness)) +
  stat_qq() + stat_qq_line() +
  facet_wrap(~sex)

ggplot(df_clean, aes(sample = extraversion)) +
  stat_qq() + stat_qq_line() +
  facet_wrap(~sex)

ggplot(df_clean, aes(sample = conscientiousness)) +
  stat_qq() + stat_qq_line() +
  facet_wrap(~sex)

```

Distribucije u skupinama su priližno normalne. Promatramo dvije
nezavisne skupine: Female i Male (ostale ćemo ukloniti). Big Five i
ostale osobine su kontinuirane.

Provest ćemo t-test za nezavisne uzorke.

```{r}
# lista osobina
traits <- c("neuroticism", "extraversion", "openness", 
            "agreeableness", "conscientiousness")

# t-test za svaku osobinu
results <- lapply(traits, function(tr) {
  formula <- as.formula(paste(tr, "~ sex")) #npr. neuroticism ~ sex 
  test <- t.test(formula, data = df_sex)
  print(test$estimate)
  tibble(
    trait = tr,#naziv osobine
    t_statistic = round(test$statistic, 3), #t vrijednost
    p_value = round(test$p.value, 5),
    mean_female = round(test$estimate["mean in group Female"], 3),
    mean_male = round(test$estimate["mean in group Male"], 3)
  )
})

results_df <- bind_rows(results)
results_df

```

Žene postižu značajno veće rezultate od muškaraca u:

Neuroticizmu (p = 0.0198 - značajna razlika)

Otvorenosti (p = 0.0323) - žene imaju statistički značajnu višu
otvorenost

Ugodnosti (p = 7.8×10⁻⁶ - vrlo značajna razlika) - žene su ugodnije.

Nema značajnih razlika u:

Ekstraverziji (p = 0.127) - žene su malo niže, a muškarci više, no
razlika nije statistički značajna.

Savjesnosti (p = 0.069).

```{r}
dark_traits <- df_sex %>%
  pivot_longer(
    cols = c(narcissism, machiavelism, psychoticism, sadism),
    names_to = "trait",
    values_to = "score"
  )

ggplot(dark_traits, aes(x = sex, y = score, fill = sex)) +
  geom_boxplot() +
  facet_wrap(~ trait, scales = "free") +
  theme_minimal() +
  labs(
    title = "Mračne osobine ličnosti po spolu (Male vs Female)",
    x = "Spol",
    y = "Rezultat"
  )

```

```{r}
dark <- c("narcissism", "machiavelism", "psychoticism", "sadism")

dark_results <- lapply(dark, function(tr) {
  formula <- as.formula(paste(tr, "~ sex"))
  test <- t.test(formula, data = df_sex)
  tibble(
    trait = tr,
    t_statistic = round(test$statistic, 3),
    p_value = round(test$p.value, 5),
    mean_female = round(test$estimate["mean in group Female"], 3),
    mean_male = round(test$estimate["mean in group Male"], 3)
  )
})

dark_results_df <- bind_rows(dark_results)
dark_results_df

```

U analizi mračnih osobina ličnosti pronađene su jasne spolne razlike.
Budući da je u t-testu korišten format tr \~ sex, negativne
t-vrijednosti ukazuju na više rezultate u skupini muškaraca u odnosu na
žene.

Rezultati pokazuju da muškarci postižu statistički značajno više
rezultate na svim analiziranim mračnim crtama — narcizmu, makijavelizmu,
psihoticizmu i sadizmu (sve p \< 0.05). Najizraženija razlika uočena je
kod sadizma, gdje muškarci ostvaruju znatno više prosječne vrijednosti u
odnosu na žene, što ukazuje na snažan spolni efekt na ovu osobinu.
