---
title: "Projekt: Analiza ličnosti i njenih mračnih crta"
author:
  - Lana Barišić
  - Marta Leš
  - Lucija Lovrić
  - Karla Šoštar
date: "2026-01-21"
output: pdf_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# instalacija - samo za prvi put
install.packages(c("tidyverse", "GGally", "ggcorrplot", "psych", "corrplot"))

```

```{r}
library(tidyverse)
library(GGally)   
library(ggcorrplot)
library(psych)
library(dplyr)
library(corrplot)

```

# Motivacija i opis problema

Ličnost je jedna od središnjih tema psihologije, a danas se najčešće
opisuje putem petofaktorskog modela Big Five, koji uključuje:
ekstraverziju (razlikuje osobe po razini društvene angažiranosti),
ugodnost (obuhvaća empatiju i kooperativnost nasuprot sumnjičavosti),
savjesnost (govori o odgovornosti nasuprot neorganiziranosti),
neuroticizam (opisuje emocionalnu nestabilnost i sklonost negativnim
emocijama) te otvorenost (označava kreativnost nasuprot
konvencionalnosti). Uz te osnovne dimenzije, česte su i procjene tzv.
mračne trijade: narcizma (povišen osjećaj vlastite važnosti i manjak
empatije), psihopatije (impulzivnost, bezosjećajnost i antisocijalnost)
i makijavelizma (manipulativnost i instrumentalno iskorištavanje
drugih). Cilj ovog projekta je analizirati u kakvoj su vezi osnovne crte
ličnosti, mračne crte ličnosti te sklonost stresu, depresiji i
anksioznosti.

# Učitavanje i pregled podataka

Podatke iz CSV datoteke učitavamo u varijablu *dataset* kako bismo ih
mogle bolje analizirati.

```{r}
dataset <- read_csv('Personality_data.csv')
```

Dalje, prikažemo prvih nekoliko redaka da vidimo primjere vrijednosti
svakog od stupaca.

```{r}
head(dataset)
```

Zatim, pomoću metoda *names()* i *glimpse()*, dajemo si bolji uvid u
tipove podataka i strukturu.

```{r}
names(dataset)
```

```{r}

glimpse(dataset)
```

Prema uvidu u strukturu podataka vidljivo je da je varijabla **age**
tipa *character*, što nije prikladno jer bi u statističkim modelima bila
tretirana kao kategorijska umjesto numerička varijabla. Stoga je
varijabla **age** pretvorena u numerički tip podataka.

Varijabla **sex** predstavlja kategorijsku varijablu te je, radi
ispravne primjene u regresijskim modelima, pretvorena u tip *factor*.

Kako bi se osigurala valjanost analize, iz uzorka su uklonjeni svi
ispitanici koji sadrže vrijednosti *CONSENT_REVOKED* ili *DATA_EXPIRED*,
budući da ti zapisi ne predstavljaju stvarne podatke ispitanika.

```{r}

data_clean <- dataset %>%
  filter(
    if_all(everything(),
           ~ !(. %in% c("CONSENT_REVOKED", "DATA_EXPIRED")))
  ) %>%
  mutate(
    age = as.numeric(age),
    sex = factor(sex)
  )


head(data_clean)
```

# Jesu li ljudi s izraženijom mračnom trijadom skloniji depresiji?

### Nezavisna varijabla (prediktori)- Mračna trijada:

-   Narcizam

-   Psihopatija

-   Makijavelizam

### Zavisna varijabla

-   Depresija (kontinuirana skala)

### Kontrolne varijable

-   Dob

-   Spol

-   Neuroticizam (važan jer je jak prediktor depresije)

-   Ostale *Big Five* crte

## Upoznavanje podataka i provjera distribucija

```{r}
describe(data_clean %>%
  select(depression, narcissism, machiavelism, psychoticism))
```

```{r}

ggplot(data_clean, aes(depression)) +
  geom_histogram(bins = 30, fill = "steelblue") +
  theme_minimal()

```

```{r}
ggplot(data_clean, aes(narcissism, depression)) +
  geom_point(alpha = 0.4) +
  geom_smooth(method = "lm", se = TRUE) +
  theme_minimal()

ggplot(data_clean, aes(machiavelism, depression)) +
  geom_point(alpha = 0.4) +
  geom_smooth(method = "lm", se = TRUE) +
  theme_minimal()

ggplot(data_clean, aes(psychoticism, depression)) +
  geom_point(alpha = 0.4) +
  geom_smooth(method = "lm", se = TRUE) +
  theme_minimal()

```

## Pearsonove korelacije

```{r}
cor.test(data_clean$depression, data_clean$narcissism)
cor.test(data_clean$depression, data_clean$machiavelism)
cor.test(data_clean$depression, data_clean$psychoticism)

```

```{r}
vars <- data_clean %>%
  select(depression, narcissism, machiavelism, psychoticism) %>%
  na.omit()

corrplot(cor(vars))


```

## Linearna regresija

```{r}
model1 <- lm(depression ~ narcissism + machiavelism + psychoticism,
             data = data_clean)

summary(model1)

```

```{r}
model2 <- lm(depression ~ narcissism + machiavelism + psychoticism +
               neuroticism + extraversion + openness +
               agreeableness + conscientiousness +
               age + sex,
             data = data_clean)

summary(model2)

```

```{r}
par(mfrow = c(2,2))
plot(model2)

```

```{r}
+
```

# Postoje li razlike u nekim crtama ličnosti među spolovima?

```{r}
# odabir 
traits_vars <- dataset %>%
  select(
    depression, anxiety, stress,
    narcissism, machiavelism, psychoticism, sadism,
    neuroticism, extraversion, openness, agreeableness, conscientiousness
  )

# korelacijska matrica
corr_mat <- cor(traits_vars, use = "pairwise.complete.obs")

# korelacijska heatmapa
ggcorrplot(
  corr_mat,
  type = "lower",
  lab = TRUE,
  lab_size = 3,
  hc.order = TRUE,
  outline.col = "white"
)

```

Osobe s većom anksioznošću, depresijom i stresom imaju tendenciju biti i
više neurotične.

Mračne osobine su međusobno umjereno povezane.

Visoka savjesnost štiti od depresije i stresa (negativna korelacija).

Ugodnost je snažno suprotna psihoticizmu i sadizmu.

Big Five su međusobno slabo do umjereno povezane.

Najveće korelacije su:

Psychoticism–Sadism (0.65) Depression–Neuroticism (0.58)
Extraversion-Narcissism(0.56) Machiavelism–Psychoticism (0.51)

```{r}
table(dataset$sex)
df_sex <- dataset %>%
  filter(sex %in% c("Male", "Female"))

```

```{r}
big_five <- df_sex %>%
  pivot_longer(
    cols = c(neuroticism, extraversion, openness, agreeableness, conscientiousness),
    names_to = "trait",
    values_to = "score"
  )

ggplot(big_five, aes(x = sex, y = score, fill = sex)) +
  geom_boxplot() +
  facet_wrap(~ trait, scales = "free") +
  theme_minimal() +
  labs(
    title = "Big Five osobine po spolu (Male vs Female)",
    x = "Spol",
    y = "Rezultat"
  )

```

U ovom uzorku se pojavljuju obrasci u skladu s očekivanjima.

Najveće razlike bilježimo kod neurotizcizma (žene više) i ugodnost (žene
više). Kod ekstraverzije, otvorenosti i savjesnosti ne bilježimo velike
razlike što se tiče medijana.

```{r}
df_clean <- dataset |> 
  filter(sex %in% c("Male", "Female"))

ggplot(df_clean, aes(sample = neuroticism)) +
  stat_qq() + stat_qq_line() +
  facet_wrap(~sex)

ggplot(df_clean, aes(sample = agreeableness)) +
  stat_qq() + stat_qq_line() +
  facet_wrap(~sex)

ggplot(df_clean, aes(sample = openness)) +
  stat_qq() + stat_qq_line() +
  facet_wrap(~sex)

ggplot(df_clean, aes(sample = extraversion)) +
  stat_qq() + stat_qq_line() +
  facet_wrap(~sex)

ggplot(df_clean, aes(sample = conscientiousness)) +
  stat_qq() + stat_qq_line() +
  facet_wrap(~sex)

```

Distribucije u skupinama su priližno normalne. Promatramo dvije
nezavisne skupine: Female i Male (ostale ćemo ukloniti). Big Five i
ostale osobine su kontinuirane.

Provest ćemo t-test za nezavisne uzorke.

```{r}
# lista osobina
traits <- c("neuroticism", "extraversion", "openness", 
            "agreeableness", "conscientiousness")

# t-test za svaku osobinu
results <- lapply(traits, function(tr) {
  formula <- as.formula(paste(tr, "~ sex")) #npr. neuroticism ~ sex 
  test <- t.test(formula, data = df_sex)
  print(test$estimate)
  tibble(
    trait = tr,#naziv osobine
    t_statistic = round(test$statistic, 3), #t vrijednost
    p_value = round(test$p.value, 5),
    mean_female = round(test$estimate["mean in group Female"], 3),
    mean_male = round(test$estimate["mean in group Male"], 3)
  )
})

results_df <- bind_rows(results)
results_df

```

Žene postižu značajno veće rezultate od muškaraca u:

Neuroticizmu (p = 0.0198 - značajna razlika)

Otvorenosti (p = 0.0323) - žene imaju statistički značajnu višu
otvorenost

Ugodnosti (p = 7.8×10⁻⁶ - vrlo značajna razlika) - žene su ugodnije.

Nema značajnih razlika u:

Ekstraverziji (p = 0.127) - žene su malo niže, a muškarci više, no
razlika nije statistički značajna.

Savjesnosti (p = 0.069).

```{r}
dark_traits <- df_sex %>%
  pivot_longer(
    cols = c(narcissism, machiavelism, psychoticism, sadism),
    names_to = "trait",
    values_to = "score"
  )

ggplot(dark_traits, aes(x = sex, y = score, fill = sex)) +
  geom_boxplot() +
  facet_wrap(~ trait, scales = "free") +
  theme_minimal() +
  labs(
    title = "Mračne osobine ličnosti po spolu (Male vs Female)",
    x = "Spol",
    y = "Rezultat"
  )

```

```{r}
dark <- c("narcissism", "machiavelism", "psychoticism", "sadism")

dark_results <- lapply(dark, function(tr) {
  formula <- as.formula(paste(tr, "~ sex"))
  test <- t.test(formula, data = df_sex)
  tibble(
    trait = tr,
    t_statistic = round(test$statistic, 3),
    p_value = round(test$p.value, 5),
    mean_female = round(test$estimate["mean in group Female"], 3),
    mean_male = round(test$estimate["mean in group Male"], 3)
  )
})

dark_results_df <- bind_rows(dark_results)
dark_results_df

```

U analizi mračnih osobina ličnosti pronađene su jasne spolne razlike.
Budući da je u t-testu korišten format tr \~ sex, negativne
t-vrijednosti ukazuju na više rezultate u skupini muškaraca u odnosu na
žene.

Rezultati pokazuju da muškarci postižu statistički značajno više
rezultate na svim analiziranim mračnim crtama — narcizmu, makijavelizmu,
psihoticizmu i sadizmu (sve p \< 0.05). Najizraženija razlika uočena je
kod sadizma, gdje muškarci ostvaruju znatno više prosječne vrijednosti u
odnosu na žene, što ukazuje na snažan spolni efekt na ovu osobinu.
